# syntax = devthefuture/dockerfile-x

FROM ghcr.io/linuxserver/baseimage-alpine:3.21
WORKDIR /home/app/build

ENV SHELL=bash
ARG NODE_ENV
ENV NODE_ENV="${NODE_ENV}"
ENV ENVIRONMENT="development"

ENV VERSION="0.0.0-dev"

RUN apk update && apk upgrade
RUN apk add npm nodejs py-pip

INCLUDE docker/stages/Dockerfile.python

RUN mkdir -p /home/app/standalone/download/incomplete/
RUN npm install -g yarn tsx

COPY . .

EXPOSE 8484
EXPOSE 3000

ENTRYPOINT ["sh", "/home/app/build/docker/run-dev.sh"]
